<% layout('layout/boilerplate.ejs') %>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="card shadow-lg border-0">
                <div class="card-header bg-primary text-white text-center py-4">
                    <h2 class="mb-0">
                        <i class="fas fa-bullseye me-3"></i><%= goal.title %>
                    </h2>
                    <p class="mb-0 mt-2 opacity-75">Goal Details</p>
                </div>

                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="text-success mb-3">
                                <i class="fas fa-info-circle me-2"></i>Goal Information
                            </h5>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">
                                    <i class="fas fa-tag text-success me-2"></i>
                                    <strong>Title:</strong> <%= goal.title %>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-cloud text-success me-2"></i>
                                    <strong>Reduction Target:</strong> <%= goal.reductionTarget %> kg COâ‚‚
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-calendar-alt text-success me-2"></i>
                                    <strong>Timeframe:</strong> <%= goal.timeframe %>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-calendar text-success me-2"></i>
                                    <strong>Start Date:</strong> <%= new Date(goal.startDate).toLocaleDateString() %>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-calendar-check text-success me-2"></i>
                                    <strong>End Date:</strong> <%= new Date(goal.endDate).toLocaleDateString() %>
                                </li>
                                <% if (goal.notes) { %>
                                    <li class="list-group-item">
                                        <i class="fas fa-sticky-note text-success me-2"></i>
                                        <strong>Notes:</strong> <%= goal.notes %>
                                    </li>
                                <% } %>
                            </ul>
                        </div>

                        <div class="col-md-6">
                            <h5 class="text-info mb-3">
                                <i class="fas fa-chart-line me-2"></i>Progress Tracking
                            </h5>
                            <div class="text-center">
                                <div class="progress-circle mb-3">
                                    <div class="progress-circle-inner">
                                        <span class="progress-text">0%</span>
                                    </div>
                                </div>
                                <p class="text-muted">Progress tracking coming soon</p>
                            </div>

                            <div class="mt-4">
                                <h6 class="text-primary">
                                    <i class="fas fa-clock me-2"></i>Time Remaining
                                </h6>
                                <p class="mb-0">
                                    <% const today = new Date(); %>
                                    <% const endDate = new Date(goal.endDate); %>
                                    <% const timeDiff = endDate - today; %>
                                    <% const daysRemaining = Math.ceil(timeDiff / (1000 * 60 * 60 * 24)); %>
                                    <% if (daysRemaining > 0) { %>
                                        <span class="badge bg-success fs-6"><%= daysRemaining %> days remaining</span>
                                    <% } else if (daysRemaining === 0) { %>
                                        <span class="badge bg-warning fs-6">Ends today</span>
                                    <% } else { %>
                                        <span class="badge bg-danger fs-6">Goal expired</span>
                                    <% } %>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-footer bg-light text-center">
                    <a href="/goals" class="btn btn-outline-secondary me-2">
                        <i class="fas fa-arrow-left me-2"></i>Back to All Goals
                    </a>
                    <a href="/goals/edit-goal/<%= goal._id %>" class="btn btn-outline-success me-2">
                        <i class="fas fa-edit me-2"></i>Edit Goal
                    </a>
                    <form action="/goals/<%= goal._id %>?_method=delete" method="POST" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this goal?')">
                        <button type="submit" class="btn btn-outline-danger">
                            <i class="fas fa-trash me-2"></i>Delete Goal
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.progress-circle {
    width: 120px;
    height: 120px;
    margin: 0 auto;
    position: relative;
}

.progress-circle-inner {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: conic-gradient(#28a745 0% 0%, #e9ecef 0% 100%);
    display: flex;
    align-items: center;
    justify-content: center;
}

.progress-text {
    font-size: 24px;
    font-weight: bold;
    color: #28a745;
}
</style>
